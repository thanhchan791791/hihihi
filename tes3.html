
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ thống phân công nhân sự</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
        }

        #assignment-form-container {
            max-width: 1200px;
            margin: auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .day-container {
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 25px;
            background-color: #fafafa;
        }

        .day-container h2 {
            margin-top: 0;
            color: #555;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .shift-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }

        .shift-section {
            flex: 1 1 45%;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 4-px;
            background-color: #fff;
        }

        .shift-section h3 {
            margin-top: 0;
            color: #777;
        }

        .job-position {
            margin-bottom: 10px;
        }

        .job-position label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #444;
        }

        .job-position input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }

        button {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 30px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        #schedule-table-container {
            display: none;
            max-width: 100vw;
            margin: auto;
        }

        .schedule-table {
            border-collapse: collapse;
            width: 100%;
            table-layout: fixed;
            margin-bottom: 30px;
        }
        
        .schedule-table th, .schedule-table td {
            border: 1px solid #ccc;
            padding: 5px;
            text-align: center;
            vertical-align: top;
            font-size: 10px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .schedule-table th {
            background-color: #007bff;
            color: #fff;
            font-weight: bold;
            text-align: center;
        }

        .schedule-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .note-row td {
            font-style: italic;
            font-weight: bold;
            padding: 8px 5px;
            text-align: left;
            background-color: #eaf6ff;
        }

        @media (max-width: 768px) {
            .schedule-table th, .schedule-table td {
                font-size: 8px;
                padding: 3px;
            }

            .schedule-table td > b {
                font-size: 10px;
            }
        }
        
        .save-button-container {
            text-align: center;
            margin-top: 20px;
        }

        .save-button-container button {
            width: auto;
            padding: 10px 20px;
        }

    </style>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>
<body>

<div id="assignment-form-container">
    <h1>NHẬP LIỆU PHÂN CÔNG TUẦN</h1>
    <form id="assignmentForm">
        <div class="day-container" id="day-2">
            <h2>Thứ 2</h2>
            <div class="shift-group">
                <div class="shift-section">
                    <h3>SÁNG</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t2-sang-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t2-sang-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t2-sang-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t2-sang-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t2-sang-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t2-sang-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t2-sang-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t2-sang-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t2-sang-capybara"></div>
                </div>
                <div class="shift-section">
                    <h3>CHIỀU</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t2-chieu-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t2-chieu-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t2-chieu-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t2-chieu-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t2-chieu-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t2-chieu-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t2-chieu-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t2-chieu-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t2-chieu-capybara"></div>
                </div>
            </div>
            <div class="job-position"><label>Ghi chú ngày:</label><input type="text" name="t2-note"></div>
        </div>

        <div class="day-container" id="day-3">
            <h2>Thứ 3</h2>
            <div class="shift-group">
                <div class="shift-section">
                    <h3>SÁNG</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t3-sang-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t3-sang-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t3-sang-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t3-sang-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t3-sang-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t3-sang-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t3-sang-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t3-sang-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t3-sang-capybara"></div>
                </div>
                <div class="shift-section">
                    <h3>CHIỀU</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t3-chieu-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t3-chieu-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t3-chieu-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t3-chieu-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t3-chieu-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t3-chieu-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t3-chieu-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t3-chieu-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t3-chieu-capybara"></div>
                </div>
            </div>
            <div class="job-position"><label>Ghi chú ngày:</label><input type="text" name="t3-note"></div>
        </div>

        <div class="day-container" id="day-4">
            <h2>Thứ 4</h2>
            <div class="shift-group">
                <div class="shift-section">
                    <h3>SÁNG</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t4-sang-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t4-sang-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t4-sang-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t4-sang-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t4-sang-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t4-sang-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t4-sang-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t4-sang-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t4-sang-capybara"></div>
                </div>
                <div class="shift-section">
                    <h3>CHIỀU</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t4-chieu-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t4-chieu-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t4-chieu-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t4-chieu-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t4-chieu-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t4-chieu-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t4-chieu-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t4-chieu-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t4-chieu-capybara"></div>
                </div>
            </div>
            <div class="job-position"><label>Ghi chú ngày:</label><input type="text" name="t4-note"></div>
        </div>

        <div class="day-container" id="day-5">
            <h2>Thứ 5</h2>
            <div class="shift-group">
                <div class="shift-section">
                    <h3>SÁNG</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t5-sang-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t5-sang-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t5-sang-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t5-sang-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t5-sang-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t5-sang-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t5-sang-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t5-sang-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t5-sang-capybara"></div>
                </div>
                <div class="shift-section">
                    <h3>CHIỀU</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t5-chieu-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t5-chieu-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t5-chieu-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t5-chieu-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t5-chieu-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t5-chieu-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t5-chieu-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t5-chieu-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t5-chieu-capybara"></div>
                </div>
            </div>
            <div class="job-position"><label>Ghi chú ngày:</label><input type="text" name="t5-note"></div>
        </div>

        <div class="day-container" id="day-6">
            <h2>Thứ 6</h2>
            <div class="shift-group">
                <div class="shift-section">
                    <h3>SÁNG</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t6-sang-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t6-sang-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t6-sang-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t6-sang-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t6-sang-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t6-sang-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t6-sang-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t6-sang-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t6-sang-capybara"></div>
                </div>
                <div class="shift-section">
                    <h3>CHIỀU</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t6-chieu-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t6-chieu-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t6-chieu-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t6-chieu-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t6-chieu-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t6-chieu-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t6-chieu-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t6-chieu-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t6-chieu-capybara"></div>
                </div>
            </div>
            <div class="job-position"><label>Ghi chú ngày:</label><input type="text" name="t6-note"></div>
        </div>

        <div class="day-container" id="day-7">
            <h2>Thứ 7</h2>
            <div class="shift-group">
                <div class="shift-section">
                    <h3>SÁNG</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t7-sang-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t7-sang-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t7-sang-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t7-sang-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t7-sang-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t7-sang-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t7-sang-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t7-sang-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t7-sang-capybara"></div>
                </div>
                <div class="shift-section">
                    <h3>CHIỀU</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="t7-chieu-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="t7-chieu-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="t7-chieu-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="t7-chieu-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="t7-chieu-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="t7-chieu-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="t7-chieu-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="t7-chieu-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="t7-chieu-capybara"></div>
                </div>
            </div>
            <div class="job-position"><label>Ghi chú ngày:</label><input type="text" name="t7-note"></div>
        </div>

        <div class="day-container" id="day-cn">
            <h2>Chủ Nhật</h2>
            <div class="shift-group">
                <div class="shift-section">
                    <h3>SÁNG</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="cn-sang-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="cn-sang-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="cn-sang-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="cn-sang-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="cn-sang-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="cn-sang-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="cn-sang-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="cn-sang-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="cn-sang-capybara"></div>
                </div>
                <div class="shift-section">
                    <h3>CHIỀU</h3>
                    <div class="job-position"><label>Oder:</label><input type="text" name="cn-chieu-oder"></div>
                    <div class="job-position"><label>Trệt:</label><input type="text" name="cn-chieu-tret"></div>
                    <div class="job-position"><label>Gấu mèo:</label><input type="text" name="cn-chieu-gaumeo"></div>
                    <div class="job-position"><label>Phòng xe:</label><input type="text" name="cn-chieu-phongxe"></div>
                    <div class="job-position"><label>Mèo:</label><input type="text" name="cn-chieu-meo"></div>
                    <div class="job-position"><label>Pet dog1:</label><input type="text" name="cn-chieu-petdog1"></div>
                    <div class="job-position"><label>Pet dog2:</label><input type="text" name="cn-chieu-petdog2"></div>
                    <div class="job-position"><label>Spa:</label><input type="text" name="cn-chieu-spa"></div>
                    <div class="job-position"><label>Capybara:</label><input type="text" name="cn-chieu-capybara"></div>
                </div>
            </div>
            <div class="job-position"><label>Ghi chú ngày:</label><input type="text" name="cn-note"></div>
        </div>

        <button type="button" onclick="generateSchedule()">Tạo bảng phân công</button>
    </form>
</div>

<div id="schedule-table-container">
    <h2>Bảng phân công ca SÁNG</h2>
    <table id="schedule-table-sang" class="schedule-table">
        <thead>
            <tr>
                <th>Vị trí</th>
                <th>Thứ 2</th>
                <th>Thứ 3</th>
                <th>Thứ 4</th>
                <th>Thứ 5</th>
                <th>Thứ 6</th>
                <th>Thứ 7</th>
                <th>Chủ Nhật</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <h2>Bảng phân công ca CHIỀU</h2>
    <table id="schedule-table-chieu" class="schedule-table">
        <thead>
            <tr>
                <th>Vị trí</th>
                <th>Thứ 2</th>
                <th>Thứ 3</th>
                <th>Thứ 4</th>
                <th>Thứ 5</th>
                <th>Thứ 6</th>
                <th>Thứ 7</th>
                <th>Chủ Nhật</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <h2>Ghi chú</h2>
    <table id="schedule-table-notes" class="schedule-table">
        <tbody>
        </tbody>
    </table>
    
    <div class="save-button-container">
        <button type="button" onclick="saveAsImage()">Lưu bảng phân công thành ảnh</button>
    </div>
</div>

<script>
    function generateSchedule() {
        const formContainer = document.getElementById('assignment-form-container');
        const tableContainer = document.getElementById('schedule-table-container');
        const tableBodySang = document.querySelector('#schedule-table-sang tbody');
        const tableBodyChieu = document.querySelector('#schedule-table-chieu tbody');
        const tableBodyNotes = document.querySelector('#schedule-table-notes tbody');

        // Ẩn form nhập liệu
        formContainer.style.display = 'none';
        // Hiển thị bảng phân công
        tableContainer.style.display = 'block';

        // Khai báo ngày và vị trí
        const days = ['t2', 't3', 't4', 't5', 't6', 't7', 'cn'];
        const positions = [
            { label: 'Oder', key: 'oder' },
            { label: 'Trệt', key: 'tret' },
            { label: 'Gấu mèo', key: 'gaumeo' },
            { label: 'Phòng xe', key: 'phongxe' },
            { label: 'Mèo', key: 'meo' },
            { label: 'Pet dog1', key: 'petdog1' },
            { label: 'Pet dog2', key: 'petdog2' },
            { label: 'Spa', key: 'spa' },
            { label: 'Capybara', key: 'capybara' }
        ];

        const data = {};

        days.forEach(day => {
            data[day] = { sang: {}, chieu: {}, note: '' };
            positions.forEach(pos => {
                const sangInput = document.querySelector(`input[name="${day}-sang-${pos.key}"]`);
                const chieuInput = document.querySelector(`input[name="${day}-chieu-${pos.key}"]`);
                
                if (sangInput) data[day].sang[pos.label] = sangInput.value;
                if (chieuInput) data[day].chieu[pos.label] = chieuInput.value;
            });
            const noteInput = document.querySelector(`input[name="${day}-note"]`);
            if (noteInput) data[day].note = noteInput.value;
        });

        // Xóa nội dung bảng cũ
        tableBodySang.innerHTML = '';
        tableBodyChieu.innerHTML = '';
        tableBodyNotes.innerHTML = '';

        // Tạo bảng phân công ca SÁNG
        positions.forEach(pos => {
            const row = document.createElement('tr');
            row.innerHTML = `<td><b>${pos.label}</b></td>`;
            days.forEach(day => {
                const cell = document.createElement('td');
                cell.textContent = data[day].sang[pos.label] || '';
                row.appendChild(cell);
            });
            tableBodySang.appendChild(row);
        });

        // Tạo bảng phân công ca CHIỀU
        positions.forEach(pos => {
            const row = document.createElement('tr');
            row.innerHTML = `<td><b>${pos.label}</b></td>`;
            days.forEach(day => {
                const cell = document.createElement('td');
                cell.textContent = data[day].chieu[pos.label] || '';
                row.appendChild(cell);
            });
            tableBodyChieu.appendChild(row);
        });

        // Tạo bảng ghi chú
        const noteRow = document.createElement('tr');
        noteRow.innerHTML = `<td style="font-weight: bold; text-align: center;">Ghi chú</td>`;
        days.forEach(day => {
            const cell = document.createElement('td');
            cell.textContent = data[day].note || '';
            noteRow.appendChild(cell);
        });
        tableBodyNotes.appendChild(noteRow);
    }
    
    function saveAsImage() {
        const scheduleContainer = document.getElementById('schedule-table-container');

        // Tạo một bản sao của container để xử lý, tránh ảnh hưởng đến hiển thị gốc
        const tempContainer = scheduleContainer.cloneNode(true);
        tempContainer.style.display = 'block'; // Đảm bảo nó được render
        tempContainer.style.position = 'absolute';
        tempContainer.style.left = '-9999px'; // Đẩy ra khỏi màn hình
        document.body.appendChild(tempContainer);
        
        // Ẩn nút "Lưu ảnh" trên bản sao trước khi chụp
        const saveButton = tempContainer.querySelector('.save-button-container');
        if (saveButton) {
            saveButton.style.display = 'none';
        }

        html2canvas(tempContainer, {
            scale: 2, // Tăng độ phân giải để ảnh sắc nét hơn
            useCORS: true // Cho phép tải các tài nguyên bên ngoài nếu có
        }).then(function(canvas) {
            // Sau khi chụp xong, xóa bản sao
            document.body.removeChild(tempContainer);

            // Chuyển canvas thành URL ảnh và tạo link tải về
            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png');
            link.download = 'bang_phan_cong_nhan_su.png';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }).catch(function(error) {
            console.error('Lỗi khi lưu ảnh:', error);
            alert('Đã xảy ra lỗi khi lưu ảnh. Vui lòng thử lại.');
        });
    }
</script>

</body>
</html>
